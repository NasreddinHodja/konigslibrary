#+TITLE: konigslibrary
#+DESCRIPTION: Browser-based manga reader

* About

konigslibrary is a manga reader that runs in your browser. It works in two modes:

- *Deployed* — visit the hosted site, upload a ZIP/CBZ, and read. Everything is client-side, nothing leaves your browser.
- *Desktop app* — native app (via Tauri) that reads manga directly from a local folder.
- *Local server* — run on your own machine to serve manga from a directory. Access from any device on your network.

* Features

- *Two reading modes* — vertical scroll or page-turn (single/double spread)
- *RTL support* — right-to-left reading with reversed navigation
- *Double-page spreads* — automatic wide-page detection for proper layout
- *Hold-to-zoom* — press =z= in page-turn mode to zoom to cursor position
- *Progress saving* — chapter and page position saved to localStorage, auto-resumes on return
- *Offline downloads* — download manga or individual chapters to IndexedDB for offline reading
- *Customizable keybindings* — rebind every shortcut from the Settings page
- *Desktop app* — native Tauri app that reads manga from a local directory with file dialog support
- *No backend required* — ZIP parsing, image extraction, and decompression all happen in the browser via the Web Compression API

* Usage

** Online (no install)

Visit the deployed site and upload a ZIP or CBZ file.

** Local Server (one-click)

Download and run the starter script — it handles everything (downloads Node.js if needed, builds the app, starts the server):

*** Linux / macOS

#+begin_src sh
curl -fSL https://github.com/NasreddinHodja/konigslibrary/raw/main/static/download/konigslibrary.sh -o konigslibrary.sh
chmod +x konigslibrary.sh
./konigslibrary.sh
#+end_src

*** Windows

Download =konigslibrary.bat= from the repo's =static/download/= directory and double-click it.

*** What happens

1. Downloads Node.js 22 (if not already installed)
2. Downloads the source, installs dependencies, builds with =adapter-node=
3. Starts the server on =http://localhost:3000=
4. Auto-opens your browser

The server prints LAN addresses so other devices on your network can connect.

** Local Server (manual)

If you already have Node.js >= 22 and pnpm:

#+begin_src sh
pnpm install
pnpm build:local
pnpm serve
#+end_src

Set =MANGA_DIR= to point at your manga directory:

#+begin_src sh
MANGA_DIR=~/Manga pnpm serve
#+end_src

Or configure it through the Settings panel in the web UI — saved to =konigslibrary.json=.

** Desktop App (Tauri)

#+begin_src sh
pnpm tauri:local          # dev mode
pnpm tauri build          # release build
#+end_src

The desktop app reads manga directly from a local folder. Use the settings gear to pick your manga directory (or use the file dialog).

** Environment Variables

| Variable      | Default       | Description                      |
|---------------+---------------+----------------------------------|
| =MANGA_DIR=  | (from config) | Path to your manga directory     |
| =PORT=       | =3000=        | Server port                      |
| =HOST=       | =0.0.0.0=     | Bind address                     |
| =LOCAL_BUILD= | (unset)      | Set to =1= for local server build |

* Keyboard Shortcuts

All shortcuts are rebindable from Settings. Defaults:

| Key              | Action                                |
|------------------+---------------------------------------|
| =j= / =↓=       | Next page                             |
| =k= / =↑=       | Previous page                         |
| =l= / =→=       | Next page (prev in RTL)               |
| =h= / =←=       | Previous page (next in RTL)           |
| =n= / =]=       | Next chapter                          |
| =p= / =[=       | Previous chapter                      |
| =z= (hold)      | Zoom to cursor (page-turn mode)       |
| =s=              | Toggle sidebar                        |
| =b=              | Back to library                       |
| =m=              | Toggle scroll / page-turn mode        |
| =r=              | Toggle LTR / RTL                      |
| =d=              | Toggle single / double page           |
| =-= / ===       | Zoom out / in (scroll mode)           |
| =?=              | Show keyboard shortcuts help          |
| =Escape=         | Close sidebar or help dialog          |

Click left/right halves of the page-turn viewer to navigate.

* Development

#+begin_src sh
pnpm install
pnpm dev
#+end_src

| Command              | Description                          |
|----------------------+--------------------------------------|
| =pnpm dev=           | Start dev server                     |
| =pnpm build=         | Production build (adapter-auto)      |
| =pnpm build:local=   | Local server build (adapter-node)    |
| =pnpm serve=         | Start local server                   |
| =pnpm check=         | Svelte type checking                 |
| =pnpm lint=          | Prettier + ESLint check              |
| =pnpm format=        | Auto-format with Prettier            |
| =pnpm tauri:local=   | Tauri dev mode                       |
| =pnpm tauri build=   | Tauri release build                  |

** Tech Stack

- Svelte 5 + SvelteKit 2
- Tailwind CSS 4
- TypeScript 5.9
- Vite 7
- Tauri 2 (desktop/mobile)
